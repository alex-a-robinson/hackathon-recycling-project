<!DOCTYPE html>
<html>
<head>
	<title></title>
</head>
<script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
<script src="/js/photo.js"></script>
<script type="text/javascript">
	
	$(document).ready(function() {
		if( /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) ) {
			$('body').html('<input id="myFileInput" type="file" accept="image/*;capture=camera">');

			var myInput = document.getElementById('myFileInput');

			function sendPic() {	
			    var file = myInput.files[0];
	  			reader = new FileReader();
	  			reader.readAsDataURL(file);
	  			reader.onload = function (evt) {
	        		send(evt.target.result.split(',')[1]);
	    		}

			    // Send file here either by adding it to a `FormData` object 
			    // and sending that via XHR, or by simply passing the file into 
			    // the `send` method of an XHR instance.
			}

			myInput.addEventListener('change', sendPic, false);
		} else {
			$('body').html('<video id="video" width="640" height="480" autoplay></video> <button id="snap">Snap Photo</button> <canvas id="canvas" width="640" height="480"></canvas>');
			// Grab elements, create settings, etc.
			var video = document.getElementById('video');

			// Get access to the camera!
			if(navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {
			    // Not adding `{ audio: true }` since we only want video now
			    navigator.mediaDevices.getUserMedia({ video: true }).then(function(stream) {
			        video.src = window.URL.createObjectURL(stream);
			        video.play();
			    });
			}
			// Elements for taking the snapshot
			var canvas = document.getElementById('canvas');
			var context = canvas.getContext('2d');
			var video = document.getElementById('video');

			// Trigger photo take
			document.getElementById("snap").addEventListener("click", function() {
				context.drawImage(video, 0, 0, 640, 480);
				send(canvas.toDataURL().split(',')[1]);
			});
		}
	});
</script>
<script src="/js/main.js"></script>
<body>
	<script src="https://www.gstatic.com/firebasejs/4.2.0/firebase.js"></script>
	<script>
    // Initialize Firebase
    var config = {
      apiKey: "AIzaSyAzSdS0FUN6ULzm_JjQh26eHSBkbMGaIZo",
      authDomain: "hackathon-12cd5.firebaseapp.com",
      databaseURL: "https://hackathon-12cd5.firebaseio.com",
      projectId: "hackathon-12cd5",
      storageBucket: "hackathon-12cd5.appspot.com",
      messagingSenderId: "388474147548"
    };
    firebase.initializeApp(config);
  </script>
	<!--
		Ideally these elements aren't created until it's confirmed that the 
		client supports video/camera, but for the sake of illustrating the 
		elements involved, they are created with markup (not JavaScript)
	-->

</body>
</html>

